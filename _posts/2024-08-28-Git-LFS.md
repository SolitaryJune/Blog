---
layout:     post
title:      "Git LFS"
subtitle:   "SVN、Perforce、"
date:       2024-08-28
update:     2024-08-30
author:     "elmagnifico"
header-img: "img/y4.jpg"
catalog:    true
tobecontinued: false
tags:
    - Git
---

## Foreword

之前选过一些资产管理软件，但是都不够好，当时遗漏了Git LFS，这里再补充测试一下



## Git LFS

![](https://img.elmagnifico.tech/static/upload/elmagnifico/git-lfs.gif)

> https://github.com/git-lfs/git-lfs

Git LFS的客户端和Git不同，但是可以使用相同的命令完成Git操作，其实LFS的底层原理挺简单，就是通过Git的时候进行回调，如果是LFS匹配的文件就进入到了LFS提交流程



将所有stp结尾的文件，加入到追踪中

```
git lfs track "*.stp"
git lfs track "*.CATDrawing"
git lfs track "*.CATPart"
git lfs track "*.dxf"
```



lfs文件追踪是加在.gitattributes文件中的

```
git add .gitattributes
git commit -m "track *.stp files using Git LFS"
```



lfs文件追踪是加在.gitattributes文件中的

```
git add .
git commit -m "add stp"
```



查看追踪文件

```
git lfs track
```



下载包含lsf的仓库时也需要加上lfs的标签

```
git lfs clone xxxx
```



### 迁移

把原来git代码中大文件变成lfs中存储

```
git lfs migrate import --include="*.stp" --everything
```



### 问题

```
$ git push -u origin master
Remote "origin" does not support the LFS locking API. Consider disabling it with:
  $ git config lfs.https://e.coding.net/xxxx/gitlfs/gitlfs.git].git/info/lfs.locksverify false
```

可能会出现以上提示，这个是服务端不支持文件锁定，所以需要配置一下让服务端关闭即可



### 测试

![image-20240829225227600](https://img.elmagnifico.tech/static/upload/elmagnifico/image-20240829225227600.png)

经过测试，1.11GB的文件，比较大的文件加入lfs以后，git add 命令会快很多

上传和下载就取决于网络和服务端限制了，正常使用似乎问题不大。



coding似乎5分钟左右就能完成2.28G的仓库上传，40秒不到就能把整个仓库完全拉下来，完全够用了

大部分硬件仓库和结构仓库，不包含一些七七八八的东西的话，用Git lfs管理足够。



![image-20240830100229470](https://img.elmagnifico.tech/static/upload/elmagnifico/image-20240830100229470.png)

配合SourceTree 给小白使用也非常简单



## LFS服务器

Git LFS，coding里是标配了20G空间，不占用原有代码空间，Gitee里只有1G基本等于没有，必须要私有部署才行



GitLab也支持LFS，不过有一些要求

- Git LFS is supported in GitLab starting with version 8.2. (gitlab版本需要 >= 8.2)
- Git LFS must be enabled under project settings  (必须在项目设置中开启LFS)
- Users need to install Git LFS client version 1.0.1 and up （本地git lfs客户端版本 >= 1.0.1）



开源的LFS存储服务器

> https://github.com/git-lfs/lfs-test-server



修改`.lfsconfig`文件，增加lfs服务器地址

```
  [lfs]
    url = "http://localhost:8080/"

```



弹性LFS，使用一些对象存储或者是云盘实现LFS服务

> https://github.com/zhxxch/git-lfs-one



## Gitea

![image-20240830164326561](https://img.elmagnifico.tech/static/upload/elmagnifico/image-20240830164326561.png)

> https://gitee.com/gitea/gitea

Gitea更像是一个简化版的Gitlab，界面干净一些



Gitea和其他DevOps的对比

> https://docs.gitea.com/zh-cn/installation/comparison

 

## SVN

> https://www.visualsvn.com/

如果只是普通的SVN本地管理是免费的，但是SVN的服务端是收费的



VisualSVN Server

> https://www.visualsvn.com/server/

![image-20240830170158664](https://img.elmagnifico.tech/static/upload/elmagnifico/image-20240830170158664.png)

VisualSVN是按照用户数收费的，买断制，所以可以根据人员决定价格，服务器自己出就行了，不过一次性付费只有12个月的更新和维护时间，后续再更新需要再次付费。

VisualSVN也有社区版本，社区版可以给15个人使用



## Summary

大部分情况LFS+Gitlab可以解决多数问题



## Quote

> https://coding.net/help/docs/admin/pay/newprice.html
>
> https://coding.net/help/docs/repo/git/lfs.html
>
> https://zhuanlan.zhihu.com/p/511750788
>
> https://zhuanlan.zhihu.com/p/146683392
>
> https://gitee.com/help/articles/4235#article-header4
>
> https://forcemz.net/git/2017/04/16/Moses/
>
> https://forcemz.net/git/2018/07/15/GitLFSRethinking/
>
> https://cloud.tencent.com/developer/article/1010589
>
> https://www.escapelife.site/posts/92ef32ff.html
