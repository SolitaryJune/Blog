---
layout:     post
title:      "ESP32开发记录"
subtitle:   "EasyCon,蓝牙,YD-ESP32-C3"
date:       2022-08-16
update:     2022-08-19
author:     "elmagnifico"
header-img: "img/y5.jpg"
catalog:    true
tags:
    - ESP32
---

## Forward

好久没弄ESP32，又要捡起来折腾一下，记录一下相关内容。



## 环境

ESP32 IDF没有IDE，所以还是依赖VS code来完成，直接搜索esp32，安装对应插件

![image-20220816004715027](http://img.elmagnifico.tech:9514/static/upload/elmagnifico/202208160047129.png)



在下一步前，建议先把代理开起来，不然下载速度感人

![image-20220816012240491](http://img.elmagnifico.tech:9514/static/upload/elmagnifico/202208160122545.png)



根据教程，F1，输入`Select where to save configuration settings` 设置一下工程路径，然后下载对应的IDF

![image-20220816011718561](http://img.elmagnifico.tech:9514/static/upload/elmagnifico/202208160117614.png)

![image-20220816005131804](http://img.elmagnifico.tech:9514/static/upload/elmagnifico/202208160051874.png)

需要注意的是这里插件其实已经把整个虚拟环境安装好了，包括各种编译需要的工具链。

所以官方教程中的编译第一个项目，需要安装的各种都可以跳过，直接进入编译调试环节就行了。



最后安装环境可能会出错

第一种是这样的错，可能是网络有问题，这种需要删掉之前的`.espressif`和`esp`路径的内容，挂vpn以后，重新安装

```shell
Command failed: "E:\switch\esp32\.espressif\tools\idf-python\3.8.7\python.exe" "E:\switch\esp32\esp\esp-idf\tools\idf_tools.py" install-python-env
    ERROR: Command errored out with exit status 1:
    ....
      File "E:\switch\esp32\.espressif\python_env\idf4.4_py3.8_env\lib\site-packages\pkg_resources\__init__.py", line 2456, in resolve
        module = __import__(self.module_name, fromlist=['__name__'], level=0)
    ModuleNotFoundError: No module named 'setuptools.command.build'
    ----------------------------------------
ERROR: Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.
WARNING: You are using pip version 20.3.3; however, version 22.2.2 is available.
You should consider upgrading via the 'E:\switch\esp32\.espressif\python_env\idf4.4_py3.8_env\Scripts\python.exe -m pip install --upgrade pip' command.
Traceback (most recent call last):
  File "E:\switch\esp32\esp\esp-idf\tools\idf_tools.py", line 1860, in <module>
    main(sys.argv[1:])
  File "E:\switch\esp32\esp\esp-idf\tools\idf_tools.py", line 1856, in main
    action_func(args)
  File "E:\switch\esp32\esp\esp-idf\tools\idf_tools.py", line 1577, in action_install_python_env
    subprocess.check_call(run_args, stdout=sys.stdout, stderr=sys.stderr, env=env_copy)
  File "subprocess.py", line 364, in check_call
subprocess.CalledProcessError: Command '['E:\\switch\\esp32\\.espressif\\python_env\\idf4.4_py3.8_env\\Scripts\\python.exe', '-m', 'pip', 'install', '--no-warn-script-location', '-r', 'E:\\switch\\esp32\\esp\\esp-idf\\requirements.txt', '--extra-index-url', 'https://dl.espressif.com/pypi']' returned non-zero exit status 1.

```



可能还会遇到出错的情况下，会提示你pip版本太低，可以手动升级一下，再重新安装

```
WARNING: You are using pip version 20.3.3; however, version 22.2.2 is available.
You should consider upgrading via the 'e:\esp32\.espressif\python_env\idf4.4_py3.8_env\Scripts\python.exe -m pip install --upgrade pip' command.

e:\switch\esp32\.espressif\python_env\idf4.4_py3.8_env\Scripts\python.exe -m pip install --upgrade pip
```

还有一种情况，如果出现了这个错，这个错不会直接报错，而且报错了也会提示在中间，不影响后续流程，但是实际上出现了以后，后续流程一定是会出错的，如果不解决这个问题，那么后面的报错是解不了的

```
error launching git: 
```

出现这个错，是因为你设置的`esp`和`.espressif`路径过长了，比如我设置的`e:\switch\esp32\.espressif`这就算过长路径了，后续的很多python的包或者git，他们对路径的长度有限制，可是他们安装的路径又特别深，这就会导致后续各种报错，要解决这个问题就需要将前面的路径清理掉，直接变成`e:\esp32\.espressif`，就能正常安装完成了



![image-20220819005334582](http://img.elmagnifico.tech:9514/static/upload/elmagnifico/202208190053658.png)

## 蓝牙 Classic HID





## Summary

未完待续



## Quote

> https://github.com/espressif/esp-idf
>
> https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32c3/get-started/index.html
>
> https://github.com/espressif/vscode-esp-idf-extension/blob/master/docs/tutorial/install.md
>
> https://github.com/espressif/esp-idf/tree/2761ad4865919693fcd02f4096711ba0fd0f6271/examples/bluetooth/bluedroid/classic_bt/bt_hid_mouse_device
>
> https://www.codenong.com/54731054/

